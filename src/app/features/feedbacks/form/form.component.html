<div class="container mt-4">
  <h2 class="mb-3 text-primary">Gestion des Feedbacks</h2>

  <!-- FORMULAIRE AJOUT -->
  <div class="card p-3 mb-4 shadow-sm">
    <h4>Ajouter un Feedback</h4>
    <form (ngSubmit)="addFeedback()">
      <div class="mb-3">
        <label class="form-label">Contenu</label>
        <textarea class="form-control"
                  [(ngModel)]="newFeedback.content"
                  name="content"
                  required></textarea>
      </div>
      <div class="mb-3">
        <label class="form-label">Note (1 - 5)</label>
        <input type="number"
               class="form-control"
               [(ngModel)]="newFeedback.rate"
               name="rate"
               min="1"
               max="5"
               required>
      </div>
      <button class="btn btn-primary w-100" type="submit">Ajouter Feedback</button>
    </form>
  </div>

  <!-- LISTE DES FEEDBACKS -->
  <div class="card p-3 shadow-sm">
    <h4>Liste des Feedbacks</h4>
    <table class="table table-striped mt-3">
      <thead>
        <tr>
          <th>Contenu</th>
          <th>Note</th>
          <th>Date</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let fb of feedbacks">

          <!-- MODE Ã‰DITION -->
          <ng-container *ngIf="editFeedbackId === fb.id; else viewMode">
            <td><input class="form-control" [(ngModel)]="editFeedbackData.content" name="editContent"></td>
            <td><input type="number" min="1" max="5" class="form-control" [(ngModel)]="editFeedbackData.rate" name="editRate"></td>
            <td>{{ fb.dateFeedback | date:'short' }}</td>
            <td>
              <button class="btn btn-success btn-sm me-2" (click)="saveEdit()">Save</button>
              <button class="btn btn-secondary btn-sm" (click)="cancelEdit()">Cancel</button>
            </td>
          </ng-container>

          <!-- MODE LECTURE -->
          <ng-template #viewMode>
            <td>{{ fb.content }}</td>
            <td>{{ fb.rate }}</td>
            <td>{{ fb.dateFeedback | date:'short' }}</td>
            <td>
              <button class="btn btn-warning btn-sm me-2" (click)="startEdit(fb)">Edit</button>
              <button class="btn btn-danger btn-sm" (click)="deleteFeedback(fb.id)">Delete</button>
            </td>
          </ng-template>
        </tr>
      </tbody>
    </table>
  </div>
</div>